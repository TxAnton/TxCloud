Задания про иерархическое содержание.

Иерархическое содержание состоит из записей, каждая запись имеет иерархический номер, название и содержит либо несколько подчинённых записей ("организующая запись"), либо текст ("текстовая запись"). Пример иерархического содержания:
0 Предисловие [текст предисловия]
1 Книга I
1.1 Часть 1
1.1.0 Пролог [текст пролога]
1.1.1 Глава 1 [текст главы]
1.1.2 Глава 2 [текст главы]
1.1.3 Глава 3 [текст главы]
1.1.4 Глава 4 [текст главы]
1.1.5 Эпилог [текст эпилога]
1.2 Часть 2
1.2.0 Пролог [текст пролога]
1.2.1 Глава 1 [текст главы]
1.2.2 Глава 2 [текст главы]
1.2.3 Глава 3 [текст главы]
1.2.4 Эпилог [текст эпилога]
2 Книга II
2.1 Глава 1 [текст главы]
2.2 Глава 2 [текст главы]
2.3 Глава 3 [текст главы]
2.4 Глава 4 [текст главы]
2.5 Эпилог [текст эпилога]
3 Книга III
3.-1 Предисловие к книге III [текст предисловия]
3.0 Пролог [текст пролога]
3.1 Часть 1
3.1.1 Глава 1 [текст главы]
3.1.2 Глава 2
3.1.2.1 Подглава 1 [текст подглавы]
3.1.2.2 Подглава 2 [текст подглавы]
3.1.3 Глава 3 [текст главы]
3.2 Отступление между частями 1 и 2 [текст отступления]
3.3 Часть 2
3.3.1 Глава 1 [текст главы]
3.3.2 Глава 2 [текст главы]
3.3.4 Главы 3-4 [текст глав]
3.4 Части с утерянным текстом
3.7 Эпилог [текст эпилога]
4 Послесловие [текст послесловия]

В текстовой записи "3.3.4 Главы 3-4 [текст глав]" "3.3.4" - это иерархический номер записи, "4" - относительный номер записи, "Главы 3-4" - название записи, а в квадратных скобках приведён текст записи.
Иерархическое содержание может быть представлено иерархическим списком, каждый элемент которого имеет название и данные - список подчинённых записей либо текст. Позиция записи в иерархическом списке определяется её номером. В элементе иерархического списка следует хранить относительный номер записи, а не её полный иерархический номер. Относительный номер каждого последующего элемента в списке должен быть больше, чем у предыдущего.
Запись с номером a.b.c обязательно должна быть в списке подчинённых записей элемента a.b (не в списке элемента a).

Задания:
Разработать программу, создающую иерархический список, соответствующий иерархическому содержанию, записанному в файле в приведённом выше формате. Записи могут быть в файле перепутаны, но все имеют различные номера. Программа должна позволять выводить иерархическое содержание на экран или в файл (в правильном порядке), добавлять новые записи (если запись с заданным номером уже существует, то сообщать об ошибке), а также выполнять дополнительные действия, в зависимости от варианта:

28)
- Удалить элемент из списка по номеру (удаляются также все подчинённые элементы);
- Удалить элемент из списка по названию (если элементов с таким названием несколько, то среди них удалить элемент с наименьшим номером);
- Редактировать название элемента;
- Изменить иерархический номер записи (если новый номер X.b уже существует или если отсутствует запись X, то сообщается об ошибке, иначе номер записи меняется на X.b и при необходимости выполняется перенос (здесь X - последовательность целых чисел (возможно, пустая), разделённых точками)).

29)
- Нормализовать номера́ элементов списка (элементы списка нумеруются натуральными числами, начиная с 1, без пропусков); операция нормализации может быть применена к верхнему уровню иерархического содержания или к подсписку с заданным иерархическим номером; может затрагивать только указанный список или распространяться на всех его потомков (по выбору пользователя);
- Вставить новую запись (если запись с заданным номером уже существует, то её номер инкрементируется, далее при необходимости по цепочке инкрементируются номера следующих записей).

30) Соединить 2 заданных соседних элемента (находящихся в одном подсписке). Информация из названий и текстов не должна потеряться. Может потребоваться перенос названия в состав текста или перенумерация элементов, подчинённых одному из объединяемых.

31) Расформировать организующую запись: все её подчинённые элементы поднимаются на уровень иерархии, соответствующий расформированной записи, название расформированной записи добавляется слева к названию первой из подчинённых записей; далее при необходимости по цепочке происходит увеличение номеров элементов, следовавших за расформированным.

32)
- Сфомировать организующую запись по трём номерам: иерархический номер записи, несколько подчинённых записей которой будут организованы в новую запись; относительные номера́ первой и последней подчинённой записей из тех, которые должны войти в состав формируемой записи.
- Изменить относительный номер записи, при этом новый номер не должен быть занят, но может быть нецелым. При необходимости выполняется перенос.

33) Пусть каждая текстовая запись хранит, помимо текста, год (число). В иерархическом списке, соответствующем иерархическому содержанию, необходимо каждому текстовому элементу добавить два указателя: на элемент, предшествующий в хронологии, и на элемент, следующий в хронологии. Если два элемента имеют одинаковый год, то более ранним считается тот элемент, который имеет меньший иерархический номер. Предоставить возможность вывести (линейный) список текстовых элементов в хронологическом порядке. При добавлении в содержание нового текстового элемента он вставляется в хронологический список на соответствующее место.